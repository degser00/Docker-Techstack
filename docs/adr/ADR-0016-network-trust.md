# ADR-0016: Network Zones and Trust Boundaries

**Date:** 2026-01-11  
**Status:** Proposed  
**Deciders:** Owner  
**Relates to:** ADR-0003 (Zero-Trust Cloudflare Access), ADR-0015 (Platform Topology and Device Classes), ADR-0012 (Compute-Centric Data Ownership)

---

## Context

As the homelab evolves into multiple physical nodes and device classes, a flat network model no longer provides sufficient isolation or clarity. Services now span internal infrastructure, user data storage, AI compute, and externally exposed components.

A clear model is required to:
- Define network zones and trust boundaries
- Prevent implicit trust between components
- Limit blast radius in case of compromise
- Align with zero-trust principles already established

---

## Decision

Adopt an explicit network zoning model with identity-based access as the primary control mechanism.

### Network Zones

1. **DMZ**
   - Hosts externally reachable services
   - Includes reverse proxies, webhook receivers, and internet-facing endpoints
   - Treated as untrusted by default

2. **Internal**
   - Hosts stateless service compute and internal application services
   - Includes observability, control, DNS, and AI compute
   - Not directly exposed to the public internet

3. **Management**
   - Hosts authoritative user-data storage and backup infrastructure
   - Includes TrueNAS systems and core backup services
   - Highest trust sensitivity

---

## Device Class to Zone Mapping

- **Stateless devices**
  - Internal zone
  - Exception: stateless services explicitly designed for exposure may live in DMZ

- **User data storing devices**
  - Management zone only

- **Windows devices**
  - Context-dependent
  - Treated as untrusted endpoints unless explicitly elevated

---

## Trust Principles

- Default deny between zones
- Explicit allow rules required for cross-zone communication
- No implicit trust based on network location alone
- Identity and service intent take precedence over IP-based trust

---

## Communication Rules (High-Level)

- **DMZ → Internal**
  - Allowed only for explicitly defined service flows

- **Internal → Management**
  - Allowed for scoped data access and backups

- **DMZ → Management**
  - Disallowed by default

- **Management → Internal**
  - Allowed for telemetry, control, and replication

- **Lateral movement within a zone**
  - Not implicitly trusted
  - Subject to identity-based controls

---

## Tailscale Role

- Provides identity-based overlay networking across all zones
- Used to:
  - Authenticate devices and services
  - Enforce least-privilege access
- Does not collapse zones into a flat network

---

## Consequences

### Benefits

- Clear and auditable trust boundaries
- Reduced impact of compromised DMZ or stateless nodes
- Alignment with zero-trust and identity-first principles
- Easier reasoning about allowed communication paths

### Costs / Tradeoffs

- Increased planning overhead for new services
- Requires discipline to avoid “temporary” trust exceptions

---

## Alternatives Considered

- **Flat network with VLANs only**
  - Rejected due to implicit trust and poor blast-radius control

- **Per-host firewall rules without zones**
  - Rejected due to lack of shared architectural intent

---

## Notes

This ADR intentionally avoids implementation details (firewalls, ports, subnets).  
Those are handled in configuration and operational documentation.
